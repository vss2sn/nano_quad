<launch>
  <arg name="vicon_name"/>
  <arg name="vicon_fps"/>
  <arg name="mass"/>

  <node pkg="vicon_odom"
    type="vicon_odom"
    name="vicon_odom"
    required="true"
    output="screen">
    <remap from="~vicon" to="/vicon/$(arg vicon_name)"/>
    <remap from="~odom" to="odom"/>
    <param name="vicon_fps" value="$(arg vicon_fps)"/>
  </node>

  <node pkg="nodelet"
    type="nodelet"
    name="standalone_nodelet"
    args="manager"
    output="screen"/>

  <!--
  <node pkg="nodelet"
    type="nodelet"
    name="controllers_manager"
    args="load controllers_manager/ControllersManager standalone_nodelet"
    output="screen">
    <rosparam file="$(find controllers_manager)/config/controllers.yaml"/>
    <rosparam file="$(find pid_control)/config/gains_ppr.yaml"/>
    <remap from="~odom" to="odom"/>
    <remap from="~cmd" to="position_cmd"/>
    <param name="line_tracker/default_v_des" value="1.0"/>
    <param name="line_tracker/default_a_des" value="1.0"/>
  </node>
  -->

  <node pkg="nodelet"
    type="nodelet"
    args="load pid_control/PIDControlNodelet standalone_nodelet"
    name="pid_control"
    required="true"
    output="screen">
    <remap from="~odom" to="odom"/>
    <remap from="~position_cmd" to="position_cmd"/>
    <remap from="~motors" to="motors"/>
    <remap from="~trpy_cmd" to="trpy_cmd"/>
    <rosparam file="$(find pid_control)/config/gains_ppr.yaml"/>
    <param name="mass" value="$(arg mass)"/>
  </node>

  <node pkg="nodelet"
    type="nodelet"
    name="quad_encode_msg"
    args="load quad_encode_msg/QuadEncodeMsg standalone_nodelet"
    output="screen">
    <remap from="~so3_cmd" to="so3_cmd"/>
    <remap from="~trpy_cmd" to="trpy_cmd"/>
    <remap from="~serial_msg" to="to_robot"/>
  </node>

  <node pkg="nodelet"
    type="nodelet"
    name="quad_decode_msg"
    args="load quad_decode_msg/QuadDecodeMsg standalone_nodelet"
    output="screen">
    <param name="quad_type" value="ppr"/>
    <remap from="~serial" to="from_robot"/>
  </node>

  <node pkg="nodelet"
    type="nodelet"
    name="quad_serial_comm"
    args="load quad_serial_comm/QuadSerialComm standalone_nodelet"
    output="screen">
    <param name="device" value="/dev/ttyACM0"/>
    <param name="baud_rate" value="230400"/>
    <remap from="~to_robot" to="to_robot"/>
    <remap from="~from_robot" to="from_robot"/>
  </node>
</launch>
